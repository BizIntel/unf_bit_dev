
&НаКлиенте
Процедура ЗаполнитьПоПодпискам(Команда)
	ЗаполнитьПоПодпискамНаСервере();
	КонецПроцедуры

&НаСервере
Процедура ЗаполнитьПоПодпискамНаСервере()
	Запрос = Новый Запрос;
	Запрос.Текст = "ВЫБРАТЬ
	               |	бизПодпискиСрезПоследних.Контрагент
	               |ИЗ
	               |	РегистрСведений.бизПодписки.СрезПоследних КАК бизПодпискиСрезПоследних
	               |ГДЕ
	               |	&Дата МЕЖДУ бизПодпискиСрезПоследних.ДатаНачалаПодписки И бизПодпискиСрезПоследних.ДатаОкончанияПодписки";			   
	Запрос.УстановитьПараметр("Дата", Дата);
	Выборка = Запрос.Выполнить().Выбрать();
	Пока Выборка.Следующий() Цикл
	   НЗ = НаборЗаписей.Добавить();
	   НЗ.Контрагент = Выборка.Контрагент;
	   НЗ.Период = Дата;		
	КонецЦикла;
	
КонецПроцедуры

&НаКлиенте
Процедура ПриОткрытии(Отказ)
	НаборЗаписей.Очистить();
	Если Не ЗначениеЗаполнено(Дата) Тогда
		Дата = ТекущаяДата();
	КонецЕсли;
КонецПроцедуры
