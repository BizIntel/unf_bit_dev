&НаСервере
Процедура ЗаполнитьОписание(ИмяМакета)
	
	Описание = Обработки.ЗагрузкаДанныхИзВнешнегоИсточника.ПолучитьМакет(ИмяМакета).ПолучитьТекст();
	
КонецПроцедуры

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	ЗаполнитьОписание("БыстрыйСтарт");
	
КонецПроцедуры

&НаКлиенте
Процедура ОткрытьФормуСправочникаИВызватьДиалогЗагрузки(ИмяСправочника, ПараметрыОткрытия)
	
	ИмяФормыСпискаСправочника = "Справочник." + ИмяСправочника + ".ФормаСписка";
	
	ФормаСправочника = ПолучитьФорму(ИмяФормыСпискаСправочника);
	Если ФормаСправочника.Открыта() Тогда
		
		ФормаСправочника.Активизировать();
		ФормаСправочника.ПодключитьОбработчикОжидания("ПоказатьПомощникЗагрузкиДанныхИзВнешнегоИсточника", 0.1, True);
		
	Иначе
		
		ОткрытьФорму(ИмяФормыСпискаСправочника, ПараметрыОткрытия);
		
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура КраткоеОписаниеПриНажатии(Элемент, ДанныеСобытия, СтандартнаяОбработка)
	
	Если ЗначениеЗаполнено(ДанныеСобытия.Element.id) Тогда
		
		СтандартнаяОбработка = Ложь;
		
		ПараметрыОткрытия = Новый Структура("ЭтоЗагрузкаИзВнешнегоИсточника", Истина);
		
		ИдентификаторКоманды = ДанныеСобытия.Element.id;
		Если СтрНайти(ИдентификаторКоманды, "Контрагенты") > 0 Тогда
			
			ОткрытьФормуСправочникаИВызватьДиалогЗагрузки("Контрагенты", ПараметрыОткрытия);
			
		ИначеЕсли СтрНайти(ИдентификаторКоманды, "Номенклатура") > 0 Тогда
			
			ОткрытьФормуСправочникаИВызватьДиалогЗагрузки("Номенклатура", ПараметрыОткрытия);
			
		ИначеЕсли СтрНайти(ИдентификаторКоманды, "ЦеныНоменклатуры") > 0 Тогда
			
			ОткрытьФормуСправочникаИВызватьДиалогЗагрузки("ВидыЦен", ПараметрыОткрытия);
			
		ИначеЕсли СтрНайти(ИдентификаторКоманды, "КраткоеОписание") > 0 Тогда
			
			ЗаполнитьОписание("КраткоеОписание");
			
		ИначеЕсли СтрНайти(ИдентификаторКоманды, "БыстрыйСтарт") > 0 Тогда
			
			ЗаполнитьОписание("БыстрыйСтарт");
			
		КонецЕсли;
		
	КонецЕсли;
	
КонецПроцедуры