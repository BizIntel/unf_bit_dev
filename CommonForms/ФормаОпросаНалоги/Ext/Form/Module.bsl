
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	Элементы.ГруппаСтраницы.ТекущаяСтраница = Элементы.ГруппаСтраницаЗаголовка;
	
	ЗаполнитьСписокРегионов();
КонецПроцедуры

&НаКлиенте
Процедура ДекорацияЗаголовокОбработкаНавигационнойСсылки(Элемент, НавигационнаяСсылкаФорматированнойСтроки, СтандартнаяОбработка)
	
	СтандартнаяОбработка = Ложь;
	
	Если НавигационнаяСсылкаФорматированнойСтроки = "Отказаться" Тогда
		
		ЗавершитьРаботу();
		
	Иначе
		
		Элементы.ГруппаСтраницы.ТекущаяСтраница = Элементы.ГруппаСтраницаОпрос;
		
	КонецЕсли;
	
КонецПроцедуры

// отваливаем константу
//
&НаСервере
Процедура ОтказатьсяОтОпроса()
	
	Константы.ФункциональнаяОпцияОпросНалоги.Установить(Ложь);
	
КонецПроцедуры

&НаСервере
Процедура ЗаполнитьСписокРегионов()
	
	СписокВыбора = Элементы.РегионДеятельности.СписокВыбора;
	
	СписокВыбора.Добавить("1","01 - Республика Адыгея ");
	СписокВыбора.Добавить("2","02 - Республика Башкортостан ");
	СписокВыбора.Добавить("3","03 - Республика Бурятия ");
	СписокВыбора.Добавить("4","04 - Республика Алтай ");
	СписокВыбора.Добавить("5","05 - Республика Дагестан ");
	СписокВыбора.Добавить("6","06 - Республика Ингушетия ");
	СписокВыбора.Добавить("7","07 - Кабардино-Балкарская Республика ");
	СписокВыбора.Добавить("8","08 - Республика Калмыкия ");
	СписокВыбора.Добавить("9","09 - Карачаево-Черкесская Республика ");
	СписокВыбора.Добавить("10","10 - Республика Карелия ");
	СписокВыбора.Добавить("11","11 - Республика Коми ");
	СписокВыбора.Добавить("12","12 - Республика Марий Эл ");
	СписокВыбора.Добавить("13","13 - Республика Мордовия ");
	СписокВыбора.Добавить("14","14 - Республика Саха (Якутия) ");
	СписокВыбора.Добавить("15","15 - Республика Северная Осетия - Алания ");
	СписокВыбора.Добавить("16","16 - Республика Татарстан ");
	СписокВыбора.Добавить("17","17 - Республика Тыва ");
	СписокВыбора.Добавить("18","18 - Удмуртская Республика ");
	СписокВыбора.Добавить("19","19 - Республика Хакасия ");
	СписокВыбора.Добавить("21","21 - Чувашская Республика ");
	СписокВыбора.Добавить("22","22 - Алтайский край ");
	СписокВыбора.Добавить("23","23 - Краснодарский край ");
	СписокВыбора.Добавить("24","24 - Красноярский край ");
	СписокВыбора.Добавить("25","25 - Приморский край ");
	СписокВыбора.Добавить("26","26 - Ставропольский край ");
	СписокВыбора.Добавить("27","27 - Хабаровский край ");
	СписокВыбора.Добавить("28","28 - Амурская область ");
	СписокВыбора.Добавить("29","29 - Архангельская область ");
	СписокВыбора.Добавить("30","30 - Астраханская область ");
	СписокВыбора.Добавить("31","31 - Белгородская область ");
	СписокВыбора.Добавить("32","32 - Брянская область ");
	СписокВыбора.Добавить("33","33 - Владимирская область ");
	СписокВыбора.Добавить("34","34 - Волгоградская область ");
	СписокВыбора.Добавить("35","35 - Вологодская область ");
	СписокВыбора.Добавить("36","36 - Воронежская область ");
	СписокВыбора.Добавить("37","37 - Ивановская область ");
	СписокВыбора.Добавить("38","38 - Иркутская область ");
	СписокВыбора.Добавить("39","39 - Калининградская область ");
	СписокВыбора.Добавить("40","40 - Калужская область ");
	СписокВыбора.Добавить("41","41 - Камчатский край ");
	СписокВыбора.Добавить("42","42 - Кемеровская область ");
	СписокВыбора.Добавить("43","43 - Кировская область ");
	СписокВыбора.Добавить("44","44 - Костромская область ");
	СписокВыбора.Добавить("45","45 - Курганская область ");
	СписокВыбора.Добавить("46","46 - Курская область ");
	СписокВыбора.Добавить("47","47 - Ленинградская область ");
	СписокВыбора.Добавить("48","48 - Липецкая область ");
	СписокВыбора.Добавить("49","49 - Магаданская область ");
	СписокВыбора.Добавить("50","50 - Московская область ");
	СписокВыбора.Добавить("51","51 - Мурманская область ");
	СписокВыбора.Добавить("52","52 - Нижегородская область ");
	СписокВыбора.Добавить("53","53 - Новгородская область ");
	СписокВыбора.Добавить("54","54 - Новосибирская область ");
	СписокВыбора.Добавить("55","55 - Омская область ");
	СписокВыбора.Добавить("56","56 - Оренбургская область ");
	СписокВыбора.Добавить("57","57 - Орловская область ");
	СписокВыбора.Добавить("58","58 - Пензенская область ");
	СписокВыбора.Добавить("59","59 - Пермский край ");
	СписокВыбора.Добавить("60","60 - Псковская область ");
	СписокВыбора.Добавить("61","61 - Ростовская область ");
	СписокВыбора.Добавить("62","62 - Рязанская область ");
	СписокВыбора.Добавить("63","63 - Самарская область ");
	СписокВыбора.Добавить("64","64 - Саратовская область ");
	СписокВыбора.Добавить("65","65 - Сахалинская область ");
	СписокВыбора.Добавить("66","66 - Свердловская область ");
	СписокВыбора.Добавить("67","67 - Смоленская область ");
	СписокВыбора.Добавить("68","68 - Тамбовская область ");
	СписокВыбора.Добавить("69","69 - Тверская область ");
	СписокВыбора.Добавить("70","70 - Томская область ");
	СписокВыбора.Добавить("71","71 - Тульская область ");
	СписокВыбора.Добавить("72","72 - Тюменская область ");
	СписокВыбора.Добавить("73","73 - Ульяновская область ");
	СписокВыбора.Добавить("74","74 - Челябинская область ");
	СписокВыбора.Добавить("75","75 - Забайкальский край ");
	СписокВыбора.Добавить("76","76 - Ярославская область ");
	СписокВыбора.Добавить("77","77 - город Москва ");
	СписокВыбора.Добавить("78","78 - город Санкт-Петербург ");
	СписокВыбора.Добавить("79","79 - Еврейская автономная область ");
	СписокВыбора.Добавить("82","82 - Республика Крым ");
	СписокВыбора.Добавить("83","83 - Ненецкий автономный округ ");
	СписокВыбора.Добавить("86","86 - Ханты-Мансийский автономный округ - Югра ");
	СписокВыбора.Добавить("87","87 - Чукотский автономный округ ");
	СписокВыбора.Добавить("89","89 - Ямало-Ненецкий автономный округ ");
	СписокВыбора.Добавить("92","92 - город Севастополь ");
	СписокВыбора.Добавить("95","95 - Чеченская Республика ");
	
КонецПроцедуры


&НаКлиенте
Процедура Отправить(Команда)
	
	ТекстПисьма = СформироватьТекст();
	
	Получатель = Новый СписокЗначений;
	Получатель.Добавить("sbm@1c.ru", "Фирма 1С");
	
	ПараметрыПисьма = Новый Структура;
	ПараметрыПисьма.Вставить("Получатель", Получатель);
	ПараметрыПисьма.Вставить("Тема", "Опрос по налогам");
	ПараметрыПисьма.Вставить("Текст", ТекстПисьма);
	
	ОП = Новый ОписаниеОповещения("ПослеОтправкиПисьма", ЭтотОбъект);
	РаботаСПочтовымиСообщениямиКлиент.СоздатьНовоеПисьмо(ПараметрыПисьма, ОП);
	
КонецПроцедуры

&НаКлиенте
Процедура ПослеОтправкиПисьма(Результат, Параметры) Экспорт
	Если Результат = Истина Тогда
		ЗавершитьРаботу();
	КонецЕсли;
КонецПроцедуры


Функция СформироватьТекст()
	
	ТекстПисьма = 
		"Тип организации: " + ТипОрганизации + Символы.ПС +
		"Продолжительность деятельности: " + ПродолжительностьДеятельности + Символы.ПС +
		"Регион деятельности: " + РегионДеятельности + Символы.ПС +
		"Применяется ОСНО: " + РежимНалогообложенияОСНО + Символы.ПС +
		"Применяется УСН: " + РежимНалогообложенияУСН + Символы.ПС +
		"Применяется ЕНВД: " + РежимНалогообложенияЕНВД + Символы.ПС +
		"Применяется патент: " + РежимНалогообложенияПатент + Символы.ПС +
		"Применяется торговый сбор: " + РежимНалогообложенияТорговыйСбор + Символы.ПС +
		"Применяется НДС: " + РежимНалогообложенияНдс + Символы.ПС +
		"Имеются сотрудники: " + ИмеютсяСотрудники + Символы.ПС +
		"Кто готовит: " + КтоГотовит + Символы.ПС +
		"Способ сдачи: " + СпособСдачи + Символы.ПС +
		"Смотрели в унф раздел: " + РазделПросмотрен + Символы.ПС +
		"Востребован: " +Востребован + Символы.ПС +
		"Пожелания: " + Пожелания;
	
	Возврат ТекстПисьма;
	
КонецФункции

&НаКлиенте
Процедура ЗавершитьРаботу()
	
	ОтказатьсяОтОпроса();
	ОбновитьИнтерфейс();
	Закрыть(Ложь);
	
КонецПроцедуры