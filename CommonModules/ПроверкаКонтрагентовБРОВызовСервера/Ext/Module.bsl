////////////////////////////////////////////////////////////////////////////////
// Проверка контрагентов: запуск проверок, сохранение настроек
//  
////////////////////////////////////////////////////////////////////////////////

#Область ПрограммныйИнтерфейс

Функция ЗаданиеВыполнено(Знач ИдентификаторЗадания) Экспорт
	
	Возврат ДлительныеОперации.ЗаданиеВыполнено(ИдентификаторЗадания);
	
КонецФункции

Функция АдресТабДокОтчетаПоНекорретнымКонтрагентамИзРегистра(Ссылка) Экспорт
	
	ВидДополнительногоФайла = "ПроверкаКонтрагентов_ТабличныйДокумент";
	
	// Отчет получаем из регистра.
	ЗаписьРегистраСведений = ПроверкаКонтрагентовБРО.ПрочитатьДанныеИзРегистра(Ссылка, ВидДополнительногоФайла);
	
	Если ЗначениеЗаполнено(ЗаписьРегистраСведений.ВидДополнительногоФайла) Тогда
		
		Возврат ПоместитьВоВременноеХранилище(ЗаписьРегистраСведений.СодержимоеФайла.Получить(), Новый УникальныйИдентификатор);
		
	Иначе
		
		Возврат Неопределено;
		
	КонецЕсли;
	
КонецФункции

#Область ОболочкаДляПодсистемыБСП

Функция ИспользованиеПроверкиВозможно() Экспорт
	
	// Проверку можно использовать даже если она не включена,
	// но при условии, что есть доступ к объектам, необходимым для проверки контрагентов.
	Если ПроверкаКонтрагентовБРО.РаботаСКонтрагентамиСуществует() Тогда
		Модуль = ОбщегоНазначения.ОбщийМодуль("ПроверкаКонтрагентов");
		Возврат Модуль.ЕстьПравоНаИспользованиеПроверки();
	Иначе
		Возврат Ложь;
	КонецЕсли;
	
КонецФункции

#КонецОбласти

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

#КонецОбласти

