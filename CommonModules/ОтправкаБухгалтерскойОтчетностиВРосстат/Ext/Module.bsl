#Область ПрограммныйИнтерфейс

Процедура ОпределитьСсылкуНаСуществующийОтчетВРосстат(Форма) Экспорт
	
	мСохраненныйДок 	= Форма.СтруктураРеквизитовФормы.мСохраненныйДок;
	Элементы			= Форма.Элементы;
	
	Если Не ЗначениеЗаполнено(Форма.ОтчетностьВРосстат) 
		ИЛИ (ЗначениеЗаполнено(Форма.ОтчетностьВРосстат) И Форма.ОтчетностьВРосстат.ПолучитьОбъект() = Неопределено) Тогда
		
		Форма.ОтчетностьВРосстат = Неопределено;
	
		Если Не ЗначениеЗаполнено(мСохраненныйДок) Тогда
			Форма.ОтчетностьВРосстат = Неопределено;
			Элементы.СоздатьБухгалтерскуюОтчетностьВРосстат.Заголовок = "Сдать в Росстат";
			Возврат;
		КонецЕсли;
		
		Запрос = Новый Запрос;
		Запрос.УстановитьПараметр("ВидОтчетности", Перечисления.ВидыОтчетности.РегламентированнаяОтчетность);
		Запрос.Текст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
		               |	РегламентированныйОтчет.Ссылка,
		               |	РегламентированныйОтчет.ДанныеОтчета
		               |ИЗ
		               |	Документ.РегламентированныйОтчет КАК РегламентированныйОтчет
		               |ГДЕ
		               |	РегламентированныйОтчет.ВидОтчетности = &ВидОтчетности
		               |	И РегламентированныйОтчет.ИсточникОтчета = ""РегламентированныйОтчетСтатистикаБухОтчетность""";
		
		Результат = Запрос.Выполнить().Выгрузить();
		Для Каждого Стр Из Результат Цикл 
			ДанныеОтчета = Стр.ДанныеОтчета.Получить();
			Если ТипЗнч(ДанныеОтчета) <> Тип("Структура") Или (Не ДанныеОтчета.Свойство("БухгалтерскаяОтчетность")) Тогда 
				Продолжить;
			КонецЕсли;
			
			Если ДанныеОтчета.БухгалтерскаяОтчетность = мСохраненныйДок Тогда
				Форма.ОтчетностьВРосстат = Стр.Ссылка;
				Элементы.СоздатьБухгалтерскуюОтчетностьВРосстат.Заголовок = "Отчет в Росстат";
				Прервать;
			КонецЕсли;
		КонецЦикла;
		
	КонецЕсли;
		
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

#КонецОбласти